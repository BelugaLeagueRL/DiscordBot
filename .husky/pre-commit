# This file is generated by Husky

echo "🔧 Running pre-commit quality checks..."

# ZERO TOLERANCE - FAIL FAST APPROACH
if [ "$SKIP_LINT" != "1" ]; then
  echo "📝 Running lint-staged (ESLint + Prettier)..."
  npx lint-staged --verbose
else
  echo "⏭️  Skipping lint-staged (SKIP_LINT=1)"
fi

if [ "$SKIP_TYPECHECK" != "1" ]; then
  echo "🔍 Running TypeScript compilation check..."
  npm run typecheck
else
  echo "⏭️  Skipping TypeScript check (SKIP_TYPECHECK=1)"
fi

if [ "$SKIP_TYPE_COVERAGE" != "1" ]; then
  echo "📊 Running type coverage check..."
  npm run type-coverage
else
  echo "⏭️  Skipping type coverage (SKIP_TYPE_COVERAGE=1)"
fi

if [ "$SKIP_ANTIPATTERN" != "1" ]; then
  echo "🛡️  Running anti-pattern detection..."
  npm run antipattern:check
else
  echo "⏭️  Skipping anti-pattern check (SKIP_ANTIPATTERN=1)"
fi

if [ "$SKIP_COVERAGE" != "1" ]; then
  echo "🧪 Running test coverage check (90% threshold)..."
  npm run test:coverage-check
else
  echo "⏭️  Skipping coverage check (SKIP_COVERAGE=1)"
fi

echo "✅ Pre-commit checks completed!"
